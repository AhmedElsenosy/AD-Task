{% extends "admin/change_form.html" %}
{% load static %}

{% block content_title %}
    <h1>Employee: {{ original|default:"Add" }}
        {% if available_ous %}
            <span style="font-size: 0.8em; margin-left: 20px; vertical-align: middle;">
                <span style="background-color: #0066cc; color: white; padding: 5px 10px; border-radius: 3px;">
                    Current OU: <strong>{{ current_ou }}</strong>
                </span>
            </span>
        {% endif %}
    </h1>
{% endblock %}

{% block after_field_sets %}
    {% if available_ous and original %}
        <div class="module" style="border: none; padding: 0; margin-top: 20px;">
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 8px 8px 0 0; color: white;">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <span style="font-size: 28px;">üîÑ</span>
                    <div>
                        <h2 style="margin: 0; font-size: 20px; color: white;">Move to Different Organizational Unit</h2>
                        <p style="margin: 5px 0 0 0; opacity: 0.95; font-size: 13px;">Reassign this employee to another OU in Active Directory</p>
                    </div>
                </div>
            </div>
            
            <form method="post" class="ou-move-form" style="padding: 20px; background-color: #ffffff; border: 1px solid #e0e0e0; border-top: none; border-radius: 0 0 8px 8px;">
                {% csrf_token %}
                
                <!-- Current Status -->
                <div style="margin-bottom: 25px; padding: 15px; background-color: #f0f7ff; border-left: 4px solid #0066cc; border-radius: 4px;">
                    <div style="margin-bottom: 10px;">
                        <strong style="color: #333;">Current Location:</strong>
                        <span style="display: inline-block; background-color: #0066cc; color: white; padding: 4px 12px; border-radius: 20px; margin-left: 10px; font-weight: bold;">
                            {{ current_ou }}
                        </span>
                    </div>
                    <small style="color: #666;">Last updated: Just now</small>
                </div>
                
                <!-- Select New OU -->
                <div style="margin-bottom: 25px;">
                    <label for="move_to_ou" style="display: block; margin-bottom: 10px; font-weight: 600; color: #333; font-size: 14px;">
                        Select New Organizational Unit
                    </label>
                    <select name="move_to_ou" id="move_to_ou" 
                            style="width: 100%; max-width: 600px; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px; background-color: white; cursor: pointer; transition: all 0.3s ease;"
                            onchange="this.style.borderColor='#667eea';" onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='#e0e0e0';"
                            required>
                        <option value="" style="color: #999;">üëâ Choose an organizational unit...</option>
                        {% for ou in available_ous %}
                            <option value="{{ ou.name }}" 
                                    {% if ou.name == current_ou %}disabled style="color: #999;"{% endif %}
                                    style="padding: 8px;">
                                üìÅ {{ ou.path }}
                                {% if ou.name == current_ou %}(You are here){% endif %}
                            </option>
                        {% endfor %}
                    </select>
                    <small style="display: block; margin-top: 8px; color: #999;">
                        {{ available_ous|length }} organizational unit{% if available_ous|length != 1 %}s{% endif %} available
                    </small>
                </div>
                
                <!-- Action Buttons -->
                <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid #e0e0e0; display: flex; gap: 10px; align-items: center;">
                    <button type="submit" name="move_to_ou" value="1" 
                            class="move-button"
                            style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 12px 28px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; display: flex; align-items: center; gap: 8px; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);">
                        <span>üöÄ</span>
                        <span>Execute Move</span>
                    </button>
                    
                    <span style="color: #999; margin-left: 15px; font-size: 13px; display: flex; align-items: center; gap: 5px;">
                        <span>‚ÑπÔ∏è</span>
                        <span>Change will be logged and applied to AD immediately</span>
                    </span>
                </div>
                
                <!-- Info Box -->
                <div style="margin-top: 20px; padding: 15px; background-color: #fffbf0; border-left: 4px solid #ff9800; border-radius: 4px; font-size: 13px; color: #666;">
                    <strong style="color: #e65100;">‚ö†Ô∏è Please Note:</strong>
                    <ul style="margin: 10px 0 0 0; padding-left: 20px;">
                        <li>This action will immediately move the user in Active Directory</li>
                        <li>All changes are automatically logged for audit purposes</li>
                        <li>The Domain Controller may take a few seconds to reflect the change</li>
                    </ul>
                </div>
            </form>
        </div>
    {% endif %}
    
    {{ block.super }}
{% endblock %}

{% block extrahead %}
    {{ block.super }}
    <style>
        .ou-move-form {
            margin: 0;
        }
        
        #move_to_ou {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        
        #move_to_ou:focus {
            outline: none;
            border-color: #667eea !important;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .move-button {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        
        .move-button:hover {
            background: linear-gradient(135deg, #218838 0%, #1aa179 100%) !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4) !important;
        }
        
        .move-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(40, 167, 69, 0.3) !important;
        }
        
        .move-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
    </style>
{% endblock %}
